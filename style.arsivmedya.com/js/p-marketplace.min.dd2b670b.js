window.AppsMarketplacePage={queryQueue:null,activeFilter:!1,appIconsLoaded:!1,getTemplatePopulator:function(a,b,c){function d(a){return a.map(function(a){var c=f.clone().removeClass("hidden");return b(a,c)||c}).reduce(function(a,b){return a.add(b)},$())}var e,f=$(a);return c?e=$(c):(e=f.parent(),f.remove()),{put:function(a){d(a).appendTo(e.empty())},append:function(a){d(a).appendTo(e)}}},getThrottledFn:function(a,b){var c=!0,d=!1;return function(){function e(){c=!1,a.apply(f,g),setTimeout(function(){d?(d=!1,e()):c=!0},b)}var f=this,g=arguments;c?e():d=!0}},getSubdoms:function(){var a,b=[];return webutils.getFormattedSubdomains().then(function(c){a=c||[],b.forEach(function(b){b(a)}),b=void 0}),function(c){return a?void c(a):void b.push(c)}}(),urlDetails:function(a){var b=encodeURIComponent(a.toLowerCase().replace(/\s/g,"-"));return"/apps/"+b},urlInstall:function(a,b,c,d){var e="plan_id=-1&";return d&&(e="plan_id="+d+"&"),"support"===c?a+"/agent/admin/apps/install/"+b+"?"+e:"sell"===c?a+"/sell/start?return_to=https://app.futuresimple.com/settings/apps/install/"+b+"?"+e:a+"/chat/agent?redirect_to=account/apps&install_app="+b+"&"+e},stagingReplace:function(a){return location.hostname.indexOf("zendesk.tv")===-1?a:location.hostname.indexOf("apps-marketplace-staging999")!==-1?a.replace("zendesk","zendesk-staging"):a.replace("zendesk","zd-staging")},init:function(){/*</sl:translate>*/
function a(a){return a.toLowerCase().replace(/[^a-zA-Z0-9\s_-]/g,"").replace(/\s/g,"-")}function b(b,d){if(b)return void console.error(b);var e=d.results,f=0,g=0;if(e.forEach(function(a){f+=a.hits.length,g+=a.nbHits,a.hits.forEach(function(b){b.parentIndex=a.index})}),0===f)return $("#hits").empty(),void $(".search-reveal").removeClass("open");var h=[];e.forEach(function(a){h=h.concat(a.hits)}),$(".search-reveal").addClass("open");var i="";if(h.forEach(function(b){var d="";if("appsIndex"===b.parentIndex){var f=b.products[0],g="Zendesk "+f.charAt(0).toUpperCase()+f.substr(1),d='<span class="search-result-icon-container"><span class="search-result-icon search-result-icon-'+f+'" title="'+g+'"></span><span class="search-result-product-name">'+f+"</span></span>",h='<span class="search-result-label search-result-label-app">'+c.appLabel+"</span>",j=b.url;j=j.replace(/\<\/?em\>/g,"")}else if("organizationsIndex"===b.parentIndex){var h='<span class="search-result-label search-result-label-partner">'+c.partnerLabel+"</span>",k=a(b.name);j="/marketplace/partners/"+k+"/"}else if("themesIndex"===b.parentIndex){var f="guide",g="Zendesk "+f.charAt(0).toUpperCase()+f.substr(1),d='<span class="search-result-icon-container"><span class="search-result-icon search-result-icon-'+f+'" title="'+g+'"></span><span class="search-result-product-name">'+f+"</span></span>",h='<span class="search-result-label search-result-label-theme">'+c.themeLabel+"</span>",k=a(b.name);j="/marketplace/themes/"+k+"/"}else{var h='<span class="search-result-label search-result-label-category">'+c.catLabel+"</span>",l=b.name.replace(/\s/g,"_");j="/apps/directory/#"+l}var m=b.name_initial?b.name_initial:b.name;i+='<div class="hit"><a class="hit-link" href="'+j+"?q=mkp_"+e[0].query+'">'+h+'<span class="search-result-name">'+m+"</span>"+d+"</a></div>"}),viewableResultCount=12,g>viewableResultCount){var j=g-12;i+='<div class="hit-more"><a href="/apps/directory/?q='+e[0].query+'" id="more-results" class="more-results">'+j+" more</a></div"}$("#hits").html(i)}webutils.lockTopNavigation();/*<sl:translate>*/
var c={searchPlaceholder:"Search The Marketplace",searchPlaceholderActive:"Enter search terms",appLabel:"App",catLabel:"App category",partnerLabel:"Partner",themeLabel:"Theme"};if($(document).ready(function(){function a(a,b,c){var d=a==g?"top_rated":"new_apps";a.search("",{hitsPerPage:12,filters:"products:"+b},function(a,b){if(b.hits.length)for(var e="",f=0;f<b.hits.length;++f){var g=b.hits[f],h=g.name.replace(/~[^a-zA-Z0-9\s_-]+~/g,"").toLowerCase();h=h.replace(/\s/g,"-");var i=g.url;g.paid?g.trial_pricing&&(g.pricing=g.trial_pricing,g.amount=g.trial_amount):g.pricing="",e+='<li class="app-item">',e+='<a href="'+i+"?source="+d+'" class="reset-color SL_norewrite">',e+="<figure>",e+='<div class="img-wrap">',g.promoted&&(e+='<span class="verified-check"></span><span class="verified-tooltip">Verified</span>'),e+="<div style=\"background-image: url('"+g.icon_url+"')\"></div>",e+="</div>",e+="</figure>",e+='<div class="details">',e+='<span class="app-title">'+g.name+"</span>",e+='<div class="app-rating">',e+='<span class="rating-stars stars-'+g.rating.average+'"></span>',e+='<span class="app-review-num"> ('+g.rating.total_count+")</span>",e+="</div>",e+='<span class="app-price">'+g.display_price+"</span>",e+="</div>",e+="</a>",e+="</li>"}e+='<li class="app-item empty"></li><li class="app-item empty"></li><li class="app-item empty"></li>',c.html(e)})}function d(){$(".apps-section-switcher").each(function(){var a=$(this),b=a.parent(".app-category-dropdown"),c=a.find("option:selected"),d=$("option",a);b.append('<dl class="highlighted dropdown"></dl>'),a.next(".highlighted").append('<dt><span class="selected">'+c.text()+'<span class="value">'+c.val()+"</span></span></dt>"),a.next(".highlighted").append("<dd><ul></ul></dd>"),d.each(function(){b.find(".highlighted dd ul").append('<li><span class="option">'+$(this).text()+'<span class="value">'+$(this).val()+"</span></span></li>")}),a.next(".highlighted").click(function(){$("dt").toggleClass("open")}),b.find("li").click(function(){var b=$(this).find(".value").text();a.val(b).trigger("change")})})}var e=$('input[name="apps-filter-search"]'),f=algoliasearch("7Z3RM3E33J","4ad1644763bb9a01fd5d8918a11c2d77");/*<sl:notranslate>*/
e.keyup(function(){var a=$(this).val();if(!a)return e.attr("placeholder",c.searchPlaceholderActive).val(""),void $(".js-search-results-container").removeClass("open");var d=[{indexName:"themesIndex",query:a,params:{hitsPerPage:2}},{indexName:"appsIndex",query:a,params:{hitsPerPage:4}},{indexName:"organizationsIndex",query:a,params:{hitsPerPage:4}},{indexName:"catIndex",query:a,params:{hitsPerPage:4}}];f.search(d,b)}).focus().closest("form").on("submit",function(){var a;return a=window.location.host.indexOf("zendesk.tv")!==-1?location.hostname:"www.zendesk.com",location.replace(location.protocol+"//"+a+"/apps/directory/?q="+encodeURIComponent(e.val())),!1}),/*</sl:notranslate>*/
$(document).click(function(a){$(a.target).closest(".search-input-box").length||!$(".js-search-results-container").hasClass("open")&&e.is(":focus")||(e.attr("placeholder",c.searchPlaceholder).val(""),$(".js-search-results-container").removeClass("open"))}),e.focus(function(){$(this).attr("placeholder",c.searchPlaceholderActive)});var g=f.initIndex("appsIndex_rating_desc"),h=f.initIndex("appsIndex_created_desc"),i={"#most-highly-rated":g,"#new-apps":h};a(g,"support",$("#most-highly-rated-support")),a(h,"chat",$("#new-apps-chat")),a(h,"sell",$("#new-apps-sell")),$(".apps-section-switcher").change(function(){var b=$(this),c="#"+b.find("option:selected").val(),d=b.attr("data-attr"),e=b.parent().find(".selected"),f=b.find("option:selected").text();e[0].innerText=f,a(i[c],d,$(c+"-"+d)),setTimeout(function(){b.closest(".content").find(".app-tiles-wrap").hide(),$(c+"-"+d).show()},700)}),e.blur(),d()}),$(".filter-product").click(function(){var a=$(this).attr("id"),b="support chat sell";$(".filter-product").removeClass("active"),$(this).addClass("active"),$(".marketplace").removeClass(b).addClass(a)}),location.search){var d=location.search.split(/\W/),e=d[1],f=d[2];if("product"===e&&f){var g=".filter-product.filter-"+f;$(g).click()}}}},$(AppsMarketplacePage.init);